"""Factory for creating datastore instances"""

import logging
from typing import Union
from firestore_datastore import FirestoreDatastore
from redis_datastore import RedisDatastore
import config

logger = logging.getLogger(__name__)


def create_datastore() -> Union[FirestoreDatastore, RedisDatastore]:
    """
    Create datastore instance based on configuration.
    
    Returns:
        FirestoreDatastore or RedisDatastore instance
    """
    datastore_type = config.DATASTORE_TYPE.lower()
    
    if datastore_type == 'firestore':
        logger.info("Creating Firestore datastore")
        return FirestoreDatastore()
    
    elif datastore_type == 'redis':
        logger.info("Creating Redis datastore")
        return RedisDatastore()
    
    else:
        raise ValueError(f"Unknown datastore type: {datastore_type}")
