"""Configuration for SCC Vulnerability Ingestion"""

import os
from dotenv import load_dotenv

# Load environment variables
ENVIRONMENT = os.environ.get('ENVIRONMENT', 'dev')
load_dotenv(f'.env.{ENVIRONMENT}')

# GCP Configuration
GCP_PROJECT_ID = os.environ.get('GCP_PROJECT_ID')
if not GCP_PROJECT_ID:
    raise ValueError(f"GCP_PROJECT_ID must be set in .env.{ENVIRONMENT}")

GCP_ORGANIZATION_ID = os.environ.get('GCP_ORGANIZATION_ID')
if not GCP_ORGANIZATION_ID:
    raise ValueError(f"GCP_ORGANIZATION_ID must be set in .env.{ENVIRONMENT}")

# Datastore Configuration
DATASTORE_TYPE = os.environ.get('DATASTORE_TYPE', 'firestore')  # 'firestore' or 'redis'
if DATASTORE_TYPE not in ['firestore', 'redis']:
    raise ValueError("DATASTORE_TYPE must be 'firestore' or 'redis'")

# Firestore Configuration
FIRESTORE_COLLECTION_VULNERABILITIES = os.environ.get('FIRESTORE_COLLECTION_VULNERABILITIES', 'scc-vulnerabilities')
FIRESTORE_COLLECTION_PROJECT_MAPPING = os.environ.get('FIRESTORE_COLLECTION_PROJECT_MAPPING', 'project-mapping')

# Redis Configuration
REDIS_HOST = os.environ.get('REDIS_HOST', 'localhost')
REDIS_PORT = int(os.environ.get('REDIS_PORT', '6379'))
REDIS_PASSWORD = os.environ.get('REDIS_PASSWORD', '')
REDIS_DB = int(os.environ.get('REDIS_DB', '0'))
REDIS_KEY_PREFIX = os.environ.get('REDIS_KEY_PREFIX', 'scc:vuln:')
REDIS_KEY_TTL = int(os.environ.get('REDIS_KEY_TTL', '86400'))  # 24 hours default

# Batch Processing Configuration
BATCH_SIZE = int(os.environ.get('BATCH_SIZE', '500'))  # Process 500 findings at a time
MAX_WORKERS = int(os.environ.get('MAX_WORKERS', '10'))  # Parallel workers

# SCC Configuration
SCC_FINDING_FILTER = os.environ.get('SCC_FINDING_FILTER', 'category="VULNERABILITY"')
SCC_PAGE_SIZE = int(os.environ.get('SCC_PAGE_SIZE', '1000'))

# Logging
LOG_LEVEL = os.environ.get('LOG_LEVEL', 'INFO')

print(f"Environment: {ENVIRONMENT}")
print(f"GCP Project: {GCP_PROJECT_ID}")
print(f"GCP Organization: {GCP_ORGANIZATION_ID}")
print(f"Datastore Type: {DATASTORE_TYPE}")
print(f"Batch Size: {BATCH_SIZE}")
print(f"Max Workers: {MAX_WORKERS}")
